<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cascade: Implementing a Custom ICascadeOrigin for Your Server</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Cascade
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_api__docs_2using__cascade_2in__depth_2implementing__origin.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Implementing a Custom ICascadeOrigin for Your Server</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md31"></a> </p>
<h1><a class="anchor" id="autotoc_md32"></a>
Introduction</h1>
<p>This guide explains how to create a custom CascadeOrigin class to enable the Cascade library to work with any API server and, optionally, handle binary blob storage. This class is crucial for adapting a specific server to work seamlessly with Cascade, providing a clean interface for the application layer while handling server-specific intricacies.</p>
<h1><a class="anchor" id="autotoc_md33"></a>
Why CascadeOrigin is Required</h1>
<p>The CascadeOrigin class serves as an adapter between your specific API server and the Cascade library. It's required because:</p>
<ol type="1">
<li>It abstracts away the details of your API, allowing Cascade applications to work with various backends</li>
<li>It provides a place to handle any irregularities or quirks in your server's API.</li>
<li>It enables the application layer to be written using a consistent, clean interface</li>
</ol>
<h1><a class="anchor" id="autotoc_md34"></a>
Minimum Contract: ICascadeOrigin</h1>
<p>The CascadeOrigin class must implement the <code>ICascadeOrigin</code> interface, which includes the following methods:</p>
<ul>
<li><code>Task&lt;T&gt; Get&lt;T&gt;(object id, bool connectionOnline)</code></li>
<li><code>Task&lt;IEnumerable&lt;T&gt;&gt; Query&lt;T&gt;(object criteria, bool connectionOnline)</code></li>
<li><code>Task&lt;T&gt; Create&lt;T&gt;(T entity, bool connectionOnline)</code></li>
<li><code>Task&lt;T&gt; Update&lt;T&gt;(T entity, bool connectionOnline)</code></li>
<li><code>Task Delete&lt;T&gt;(T entity, bool connectionOnline)</code></li>
<li><code>Task&lt;byte[]&gt; BlobGet(string path, bool connectionOnline)</code></li>
<li><code>Task BlobPut(string path, byte[] data, bool connectionOnline)</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md35"></a>
Recommended Implementation Approach</h1>
<p>While not required, it has been a successful approach to :</p>
<ol type="1">
<li>Use <code>IModelClassOrigin&lt;T&gt;</code> implementations for each model class.</li>
<li>Use a <code>IBlobOrigin</code> implementation for binary blob handling.</li>
<li>Use a <code>ICascadeOrigin</code> implementation to combine the above</li>
</ol>
<p>This modular approach allows for easier maintenance and extensibility with minimum repetition, and is the approach documented here.</p>
<h1><a class="anchor" id="autotoc_md36"></a>
Implementation Guide</h1>
<h2><a class="anchor" id="autotoc_md37"></a>
1. Basic Origin Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>CustomCascadeOrigin : ICascadeOrigin</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly Dictionary&lt;Type, IModelClassOrigin&gt; _classOrigins;</div>
<div class="line">    <span class="keyword">private</span> readonly IBlobOrigin _blobOrigin;</div>
<div class="line">    <span class="keyword">private</span> readonly CascadeJsonSerialization _serialization;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> CustomCascadeOrigin(</div>
<div class="line">        Dictionary&lt;Type, IModelClassOrigin&gt; classOrigins,</div>
<div class="line">        IBlobOrigin blobOrigin,</div>
<div class="line">        CascadeJsonSerialization serialization)</div>
<div class="line">    {</div>
<div class="line">        _classOrigins = classOrigins;</div>
<div class="line">        _blobOrigin = blobOrigin;</div>
<div class="line">        _serialization = serialization;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task&lt;OpResponse&gt; ProcessRequest(RequestOp request, <span class="keywordtype">bool</span> connectionOnline) {</div>
<div class="line">        <span class="keywordtype">object</span>? result = <span class="keyword">null</span>;</div>
<div class="line">        IModelClassOrigin? co = <span class="keyword">null</span>;</div>
<div class="line">        <span class="keywordtype">bool</span> exists = <span class="keyword">false</span>;</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> (request.Verb!=RequestVerb.BlobGet &amp;&amp; request.Verb!=RequestVerb.BlobPut &amp;&amp; request.Verb!=RequestVerb.BlobDestroy &amp;&amp; !classOrigins.TryGetValue(request.Type, out co))</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException($<span class="stringliteral">&quot;Unknown origin type ${request.Type.FullName}&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">try</span> {</div>
<div class="line">            <span class="keywordflow">switch</span> (request.Verb) {</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.Query:</div>
<div class="line">                    Debug.Assert(request.Key != <span class="keyword">null</span>, <span class="stringliteral">&quot;request.Key != null&quot;</span>);</div>
<div class="line">                    result = await co!.Query(request.Criteria);</div>
<div class="line">                    exists = (result is IEnumerable e) &amp;&amp; e.GetEnumerator().MoveNext();</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.Get:</div>
<div class="line">                    result = await co!.Get(request.Id);</div>
<div class="line">                    exists = result != <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.Create:</div>
<div class="line">                    result = await co!.Create(request.Value);</div>
<div class="line">                    exists = result != <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.Replace:</div>
<div class="line">                    result = await co!.Replace(request.Value);</div>
<div class="line">                    exists = result != <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.Update:</div>
<div class="line">                    result = await co!.Update(request.Id, (IDictionary&lt;string, object&gt;)request.Value, request.Extra);</div>
<div class="line">                    exists = result != <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.Destroy:</div>
<div class="line">                    await co!.Destroy(request.Value);</div>
<div class="line">                    exists = <span class="keyword">false</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.Execute:</div>
<div class="line">                    result = await co!.Execute(request,connectionOnline);</div>
<div class="line">                    exists = <span class="keyword">true</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.BlobGet:</div>
<div class="line">                    <span class="keywordflow">if</span> (blobOrigin==<span class="keyword">null</span>)</div>
<div class="line">                        <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();    </div>
<div class="line">                    result = await blobOrigin.BlobGet(request,connectionOnline);</div>
<div class="line">                    exists = result != <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.BlobPut:</div>
<div class="line">                    <span class="keywordflow">if</span> (blobOrigin==<span class="keyword">null</span>)</div>
<div class="line">                        <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();    </div>
<div class="line">                    result = await blobOrigin.BlobPut(request,connectionOnline);</div>
<div class="line">                    exists = result != <span class="keyword">null</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> RequestVerb.BlobDestroy:</div>
<div class="line">                    <span class="keywordflow">if</span> (blobOrigin==<span class="keyword">null</span>)</div>
<div class="line">                        <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();    </div>
<div class="line">                    await blobOrigin.BlobDestroy(request,connectionOnline);</div>
<div class="line">                    exists = <span class="keyword">false</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> (NotFoundException e) {</div>
<div class="line">            exists = <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> (StandardException e) when (</div>
<div class="line">            e is NoNetworkException ||</div>
<div class="line">            e is InternalServerErrorException</div>
<div class="line">        ) {</div>
<div class="line">            <span class="keywordflow">throw</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span> (Exception e) {</div>
<div class="line">            <span class="keywordflow">throw</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        var opResponse = <span class="keyword">new</span> OpResponse(</div>
<div class="line">            request,</div>
<div class="line">            NowMs,</div>
<div class="line">            exists,</div>
<div class="line">            NowMs,</div>
<div class="line">            result</div>
<div class="line">        );</div>
<div class="line">        opResponse.SourceName = this.GetType().Name;</div>
<div class="line">        <span class="keywordflow">return</span> opResponse;</div>
<div class="line">    }    </div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md38"></a>
2. Basic Class Origin Structure</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>CivtracSimpleClassOrigin&lt;M&gt; : IModelClassOrigin where M : SuperModel  {</div>
<div class="line">  <span class="keyword">public</span> BaseHttpApiClient HttpApiClient { <span class="keyword">get</span>; }</div>
<div class="line">  <span class="keyword">public</span> <span class="keywordtype">string</span> ResourcePath { <span class="keyword">get</span>; }</div>
<div class="line">  <span class="keyword">public</span> CascadeJsonSerialization Serialization { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span> ICascadeOrigin Origin { <span class="keyword">get</span>; <span class="keyword">set</span>; }    </div>
<div class="line">  </div>
<div class="line">  <span class="keyword">public</span> CivtracSimpleClassOrigin(</div>
<div class="line">    <span class="keywordtype">string</span> resourcePath, </div>
<div class="line">    BaseHttpApiClient httpApiClient, </div>
<div class="line">    CascadeJsonSerialization serialization,</div>
<div class="line">    Func&lt;CivtracSimpleClassOrigin&lt;M&gt;,RequestOp,<span class="keywordtype">bool</span>,Task&lt;object&gt;&gt; executeHandler = <span class="keyword">null</span>,</div>
<div class="line">    <span class="keywordtype">string</span> queryResponsePath = <span class="stringliteral">&quot;items&quot;</span></div>
<div class="line">  ) {</div>
<div class="line">    HttpApiClient = httpApiClient;</div>
<div class="line">    ResourcePath = StringUtils.EnsureEndingSlash(resourcePath);</div>
<div class="line">    Serialization = serialization;      </div>
<div class="line">    ExecuteHandler = executeHandler;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;IEnumerable&gt; Query(<span class="keywordtype">object</span> criteria) {</div>
<div class="line">    var criteriaDict = criteria as IDictionary&lt;string, object&gt;;</div>
<div class="line">    <span class="keywordtype">string</span> aUrl = ResourcePath;</div>
<div class="line">    var response = await HttpApiClient.Get (aUrl,criteriaDict);</div>
<div class="line">    response.EnsureSuccessStatusCode();</div>
<div class="line">    var s = await response.Content.ReadAsStringAsync ();</div>
<div class="line">    var jsonElement = AppCommon.Serialization.DeserializeElement(s);</div>
<div class="line">    var ret = AppCommon.Serialization.DeserializeType&lt;IEnumerable&lt;M&gt;&gt;(jsonElement);</div>
<div class="line">    var items = (ret).ToImmutableArray();</div>
<div class="line">    <span class="keywordflow">return</span> items;</div>
<div class="line">  }</div>
<div class="line">      </div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Get(<span class="keywordtype">object</span> <span class="keywordtype">id</span>) {</div>
<div class="line">      var url = $<span class="stringliteral">&quot;{ResourcePath}{id}&quot;</span>;</div>
<div class="line">      var item = await HttpApiClient.GetAs&lt;M&gt;(url);</div>
<div class="line">      <span class="keywordflow">return</span> item;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Create(<span class="keywordtype">object</span> value) {</div>
<div class="line">    var item = await HttpApiClient.PostAs&lt;M&gt;(ResourcePath, value);</div>
<div class="line">    <span class="keywordflow">return</span> item;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Replace(<span class="keywordtype">object</span> value) {</div>
<div class="line">    var url = this.ResourcePath+CascadeTypeUtils.GetCascadeId(value).ToString();</div>
<div class="line">    var item = await HttpApiClient.PutAs&lt;M&gt;(url, value);</div>
<div class="line">    <span class="keywordflow">return</span> item;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Update(<span class="keywordtype">object</span> <span class="keywordtype">id</span>, IDictionary&lt;string, object&gt; changes, <span class="keywordtype">object</span> model) {</div>
<div class="line">    var url = this.ResourcePath+CascadeTypeUtils.GetCascadeId(value).ToString();</div>
<div class="line">    var item = await HttpApiClient.UpdateAs&lt;M&gt;(url, changes);</div>
<div class="line">    <span class="keywordflow">return</span> item;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">public</span> <span class="keyword">virtual</span> async Task Destroy(<span class="keywordtype">object</span> model) {</div>
<div class="line">    var url = $<span class="stringliteral">&quot;{ResourcePath}{CascadeTypeUtils.GetCascadeId(model)}&quot;</span>;  </div>
<div class="line">    await HttpApiClient.Delete(url);</div>
<div class="line">  }    </div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md39"></a>
2. Implementing Core Methods</h2>
<p>The following is a very basic example. In practice you may want to support lambda based handlers for customising each method per model class specifically.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;IEnumerable&gt; Query(<span class="keywordtype">object</span> criteria) {</div>
<div class="line">  var criteriaDict = criteria as IDictionary&lt;string, object&gt;;</div>
<div class="line">  <span class="keywordtype">string</span> aUrl = ResourcePath;</div>
<div class="line">  var response = await HttpApiClient.Get (aUrl,criteriaDict);</div>
<div class="line">  response.EnsureSuccessStatusCode();</div>
<div class="line">  var s = await response.Content.ReadAsStringAsync ();</div>
<div class="line">  var jsonElement = AppCommon.Serialization.DeserializeElement(s);</div>
<div class="line">  var ret = AppCommon.Serialization.DeserializeType&lt;IEnumerable&lt;M&gt;&gt;(jsonElement);</div>
<div class="line">  var items = (ret).ToImmutableArray();</div>
<div class="line">  <span class="keywordflow">return</span> items;</div>
<div class="line">}</div>
<div class="line">    </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Get(<span class="keywordtype">object</span> <span class="keywordtype">id</span>) {</div>
<div class="line">    var url = $<span class="stringliteral">&quot;{ResourcePath}{id}&quot;</span>;</div>
<div class="line">    var item = await HttpApiClient.GetAs&lt;M&gt;(url);</div>
<div class="line">    <span class="keywordflow">return</span> item;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Create(<span class="keywordtype">object</span> value) {</div>
<div class="line">  var item = await HttpApiClient.PostAs&lt;M&gt;(ResourcePath, value);</div>
<div class="line">  <span class="keywordflow">return</span> item;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Replace(<span class="keywordtype">object</span> value) {</div>
<div class="line">  var url = this.ResourcePath+CascadeTypeUtils.GetCascadeId(value).ToString();</div>
<div class="line">  var item = await HttpApiClient.PutAs&lt;M&gt;(url, value);</div>
<div class="line">  <span class="keywordflow">return</span> item;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task&lt;object&gt; Update(<span class="keywordtype">object</span> <span class="keywordtype">id</span>, IDictionary&lt;string, object&gt; changes, <span class="keywordtype">object</span> model) {</div>
<div class="line">  var url = this.ResourcePath+CascadeTypeUtils.GetCascadeId(value).ToString();</div>
<div class="line">  var item = await HttpApiClient.UpdateAs&lt;M&gt;(url, changes);</div>
<div class="line">  <span class="keywordflow">return</span> item;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> async Task Destroy(<span class="keywordtype">object</span> model) {</div>
<div class="line">  var url = $<span class="stringliteral">&quot;{ResourcePath}{CascadeTypeUtils.GetCascadeId(model)}&quot;</span>;  </div>
<div class="line">  await HttpApiClient.Delete(url);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md40"></a>
3. Implementing Blob Handling</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> async Task&lt;byte[]&gt; BlobGet(<span class="keywordtype">string</span> path, <span class="keywordtype">bool</span> connectionOnline)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> await _blobOrigin.Get(path, connectionOnline);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> async Task BlobPut(<span class="keywordtype">string</span> path, <span class="keywordtype">byte</span>[] data, <span class="keywordtype">bool</span> connectionOnline)</div>
<div class="line">{</div>
<div class="line">    await _blobOrigin.Put(path, data, connectionOnline);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md41"></a>
Key Considerations</h1>
<h2><a class="anchor" id="autotoc_md42"></a>
Authentication</h2>
<p>Handle authentication within your API client or individual methods:</p>
<div class="fragment"><div class="line"><span class="keyword">private</span> async Task&lt;string&gt; GetAuthToken()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Implement authentication logic</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> async Task&lt;T&gt; Get&lt;T&gt;(<span class="keywordtype">object</span> <span class="keywordtype">id</span>) where T : <span class="keyword">class</span></div>
<div class="line">{</div>
<div class="line">    var token = await GetAuthToken();</div>
<div class="line">    <span class="comment">// Use token in API request</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43"></a>
Exception Handling</h2>
<p>Cascade uses and includes the StandardExceptions library and ErrorControl class. Exceptions thrown (for example, by a HTTP client library) are recognised, filtered and usually wrapped in an appropriate StandardException subclass by a handler registered with ErrorControl.</p>
<p>For example, <code>Java.Net.UnknownHostException</code> is wrapped with a <code>NoNetworkException</code> by setting the Inner property of the StandardException. This means that the Cascade library can handle a known exception representing the case where an attempt at a network connection has failed, and the original exception is also available if required.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
Serialization</h2>
<p>The included <code>CascadeJsonSerialization</code> provides consistent data handling using the dotnet System.Text.Json library.</p>
<h2><a class="anchor" id="autotoc_md45"></a>
Online/Offline Behavior</h2>
<p>When CascadeDataLayer::ConnectionOnline is false (offline mode), the origin is only used to handle Execute requests as Cascade simulates the other operations. Execute is passed the connectionOnline parameter to conditionally handle online and offline scenarios. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
