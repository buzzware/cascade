<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cascade: Collections in Depth</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Cascade
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('collections_in_depth.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Collections in Depth</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In Cascade, a collection is an array of ids. At present the <code>PrimaryKey</code> of a Cascade model can be typed int, long or string. So a collection is actually an array of one of those types. This is not often seen by an application because the Query method takes that array and looks up the matching models using GetModelsForIds() to return an array of models.</p>
<p>However there are edge cases when it may be necessary or desirable to use collections directly.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Collection Requests</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> async Task&lt;IEnumerable&lt;object&gt;?&gt; GetCollection&lt;M&gt;(</div>
<div class="line">    <span class="keywordtype">string</span> collectionName,</div>
<div class="line">    <span class="keywordtype">long</span>? sequenceBeganMs = <span class="keyword">null</span></div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">and </div>
<div class="line"> </div>
<div class="line">public Task&lt;OpResponse&gt; GetCollectionResponse&lt;M&gt;(<span class="keywordtype">string</span> collectionName, <span class="keywordtype">long</span>? sequenceBeganMs = null)</div>
</div><!-- fragment --><p>Like Get for collections where the collectionName is like the id. Returns an array of ids.</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> async Task&lt;IEnumerable&lt;M&gt;&gt; GetWhereCollection&lt;M&gt;(</div>
<div class="line">  <span class="keywordtype">string</span> propertyName, </div>
<div class="line">  <span class="keywordtype">string</span> propertyValue, </div>
<div class="line">  <span class="keywordtype">int</span>? freshnessSeconds = <span class="keyword">null</span>, </div>
<div class="line">  <span class="keywordtype">int</span>? populateFreshnessSeconds = <span class="keyword">null</span>,</div>
<div class="line">  <span class="keywordtype">long</span>? sequenceBeganMs = <span class="keyword">null</span></div>
<div class="line">)</div>
<div class="line">    </div>
<div class="line">and</div>
<div class="line"> </div>
<div class="line">public async Task&lt;OpResponse&gt; GetWhereCollectionResponse&lt;Model&gt;(</div>
<div class="line">  <span class="keywordtype">string</span> propertyName, </div>
<div class="line">  <span class="keywordtype">string</span> propertyValue, </div>
<div class="line">  <span class="keywordtype">int</span>? freshnessSeconds = null, </div>
<div class="line">  <span class="keywordtype">int</span>? populateFreshnessSeconds = null,</div>
<div class="line">  <span class="keywordtype">long</span>? sequenceBeganMs = null</div>
<div class="line">)</div>
</div><!-- fragment --><p>Get a collection of models where a given property name has the given value. Used for populating HasMany or HasOne associations. This is specialised form of Query/QueryResponse&lt;Model&gt;()</p>
<div class="fragment"><div class="line"><span class="keyword">public</span> async Task&lt;IEnumerable&lt;OpResponse&gt;&gt; GetModelsForIds(</div>
<div class="line">  Type type,</div>
<div class="line">  IEnumerable iids,</div>
<div class="line">  <span class="keywordtype">int</span>? freshnessSeconds = <span class="keyword">null</span>,</div>
<div class="line">  <span class="keywordtype">int</span>? fallbackFreshnessSeconds = <span class="keyword">null</span>,</div>
<div class="line">  <span class="keywordtype">bool</span>? hold = <span class="keyword">null</span>,</div>
<div class="line">  <span class="keywordtype">long</span>? sequenceBeganMs = <span class="keyword">null</span></div>
<div class="line">)</div>
</div><!-- fragment --><p>Get the models for the given ids.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Collection Helper methods</h2>
<p>The following methods are used to manage collections directly as a list of ids.</p>
<div class="fragment"><div class="line">async Task&lt;IEnumerable&lt;object&gt;&gt; SetCollection&lt;Model&gt;(<span class="keywordtype">string</span> collectionName, IEnumerable&lt;object&gt; ids)</div>
</div><!-- fragment --><p>Replace a collection with a specified set of ids in all cache layers.</p>
<div class="fragment"><div class="line">async Task&lt;IEnumerable&lt;object&gt;&gt; CollectionPrepend&lt;Model&gt;(<span class="keywordtype">string</span> collectionName, <span class="keywordtype">object</span> <span class="keywordtype">id</span>)</div>
</div><!-- fragment --><p>Add a single id to the beginning of a collection in all cache layers.</p>
<div class="fragment"><div class="line">async Task&lt;IEnumerable&lt;object&gt;&gt; CollectionAppend&lt;Model&gt;(<span class="keywordtype">string</span> collectionName, <span class="keywordtype">object</span> <span class="keywordtype">id</span>)</div>
</div><!-- fragment --><p>Add a single id to the end of a collection in all cache layers.</p>
<div class="fragment"><div class="line">async Task ClearCollection&lt;Model&gt;(<span class="keywordtype">string</span> collectionName)</div>
</div><!-- fragment --><p>Clear a collection from all cache layers for the specified collection type.</p>
<div class="fragment"><div class="line">async Task SetCacheWhereCollection(Type modelType, <span class="keywordtype">string</span> propertyName, <span class="keywordtype">string</span> propertyValue, IEnumerable&lt;object&gt; collection)</div>
</div><!-- fragment --><p>Replace a where collection in all Cascade caches with the given array of ids <br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
